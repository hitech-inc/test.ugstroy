!function(b){b.fn.ripple=function(o){if(1<this.length)return this.each(function(e,t){b(t).ripple(o)});if(o=o||{},this.off(".ripple").data("unbound",!0),o.unbind)return this;var t=function(){return d&&!d.data("unbound")};this.addClass("legitRipple").removeData("unbound").on("tap.ripple",function(e){t()||(d=b(this),x(e.coords))}).on("dragstart.ripple",function(e){g.allowDragging||e.preventDefault()}),b(document).on("move.ripple",function(e){t()&&w(e.coords)}).on("end.ripple",function(){t()&&y()}),b(window).on("scroll.ripple",function(e){t()&&y()});var n,i,a,r,s=function(e){return!!e.type.match(/^touch/)},l=function(e,t){return s(e)&&(e=p(e.originalEvent.touches,t)),[e.pageX,e.pageY]},p=function(e,n){return b.makeArray(e).filter(function(e,t){return e.identifier==n})[0]},c=0,u=function(e){"touchstart"==e.type&&(c=3),"scroll"==e.type&&(c=0);var t=c&&!s(e);return t&&c--,!t};this.on("mousedown.ripple touchstart.ripple",function(e){u(e)&&(n=s(e)?e.originalEvent.changedTouches[0].identifier:-1,i=b(this),a=b.Event("tap",{coords:l(e,n)}),~n?r=setTimeout(function(){i.trigger(a),r=null},g.touchDelay):i.trigger(a))}),b(document).on("mousemove.ripple touchmove.ripple mouseup.ripple touchend.ripple touchcancel.ripple",function(e){var t=e.type.match(/move/);r&&!t&&(clearTimeout(r),r=null,i.trigger(a)),u(e)&&(s(e)?p(e.originalEvent.changedTouches,n):!~n)&&b(this).trigger(t?b.Event("move",{coords:l(e,n)}):"end")}).on("contextmenu.ripple",function(e){u(e)}).on("touchmove",function(){clearTimeout(r),r=null});var d,f,h,m,g={},v=0,x=function(e){var t;h=[d.outerWidth(),d.outerHeight()],t={fixedPos:null,get dragging(){return!g.fixedPos},get adaptPos(){return g.dragging},get maxDiameter(){return Math.sqrt(Math.pow(h[0],2)+Math.pow(h[1],2))/d.outerWidth()*Math.ceil(g.adaptPos?100:200)+"%"},scaleMode:"fixed",template:null,allowDragging:!1,touchDelay:100,callback:null},b.each(t,function(e,t){g[e]=e in o?o[e]:t}),m=e,f=b("<span/>").addClass("legitRipple-ripple"),g.template&&f.append(("object"==typeof g.template?g.template:d.children(".legitRipple-template").last()).clone().removeClass("legitRipple-template")).addClass("legitRipple-custom"),f.appendTo(d),D(e,!1);var n=f.css("transition-duration").split(","),i=[5.5*parseFloat(n[0])+"s"].concat(n.slice(1)).join(",");f.css("transition-duration",i).css("width",g.maxDiameter),f.on("transitionend webkitTransitionEnd oTransitionEnd",function(){b(this).data("oneEnded")?b(this).off().remove():b(this).data("oneEnded",!0)})},w=function(e){var t;if(v++,"proportional"===g.scaleMode){var n=Math.pow(v,v/100*.6);t=40<n?40:n}else if("fixed"==g.scaleMode&&6<Math.abs(e[1]-m[1]))return void y();D(e,t)},y=function(){f.css("width",f.css("width")).css("transition","none").css("transition","").css("width",f.css("width")).css("width",g.maxDiameter).css("opacity","0"),d=null,v=0},D=function(e,t){var n=[],i=!0===g.fixedPos?[.5,.5]:[(g.fixedPos?g.fixedPos[0]:e[0]-d.offset().left)/h[0],(g.fixedPos?g.fixedPos[1]:e[1]-d.offset().top)/h[1]],o=[.5-i[0],.5-i[1]],a=[100/parseFloat(g.maxDiameter),100/parseFloat(g.maxDiameter)*(h[1]/h[0])],r=[o[0]*a[0],o[1]*a[1]],s=g.dragging||0===v;if(s&&"inline"==d.css("display")){var l=b("<span/>").text("Hi!").css("font-size",0).prependTo(d),p=l.offset().left;l.remove(),n=[e[0]-p+"px",e[1]-d.offset().top+"px"]}s&&f.css("left",n[0]||100*i[0]+"%").css("top",n[1]||100*i[1]+"%"),f.css("transform","translate3d(-50%, -50%, 0)"+(g.adaptPos?"translate3d("+100*r[0]+"%, "+100*r[1]+"%, 0)":"")+(t?"scale("+t+")":"")),g.callback&&g.callback(d,f,i,g.maxDiameter)};return this},b.ripple=function(e){b.each(e,function(e,t){b(e).ripple(t)})},b.ripple.destroy=function(){b(".legitRipple").removeClass("legitRipple").add(window).add(document).off(".ripple"),b(".legitRipple-ripple").remove()}}(jQuery);